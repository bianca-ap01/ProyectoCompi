{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/bianca/Documents/compi/ProyectoCompi/frontend/components/grammar-panel.tsx"],"sourcesContent":["\"use client\"\n\nimport Editor from \"@monaco-editor/react\"\n\ninterface GrammarPanelProps {\n  code: string\n  setCode: (value: string) => void\n}\n\nexport function GrammarPanel({ code, setCode }: GrammarPanelProps) {\n  const handleEditorChange = (value: string | undefined) => {\n    if (value) setCode(value)\n  }\n\n  return (\n    <div className=\"h-full w-full\">\n      <Editor\n        height=\"100%\"\n        defaultLanguage=\"c\"\n        theme=\"vs-dark\"\n        value={code}\n        onChange={handleEditorChange}\n        options={{\n          minimap: { enabled: false },\n          fontSize: 14,\n          fontFamily: \"'JetBrains Mono', 'Fira Code', monospace\",\n          lineNumbers: \"on\",\n          scrollBeyondLastLine: false,\n          automaticLayout: true,\n          tabSize: 4,\n          padding: { top: 16, bottom: 16 },\n          renderLineHighlight: \"gutter\",\n          cursorBlinking: \"smooth\",\n          smoothScrolling: true,\n          bracketPairColorization: { enabled: true },\n        }}\n      />\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AASO,SAAS,aAAa,EAAE,IAAI,EAAE,OAAO,EAAqB;IAC/D,MAAM,qBAAqB,CAAC;QAC1B,IAAI,OAAO,QAAQ;IACrB;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC,wLAAM;YACL,QAAO;YACP,iBAAgB;YAChB,OAAM;YACN,OAAO;YACP,UAAU;YACV,SAAS;gBACP,SAAS;oBAAE,SAAS;gBAAM;gBAC1B,UAAU;gBACV,YAAY;gBACZ,aAAa;gBACb,sBAAsB;gBACtB,iBAAiB;gBACjB,SAAS;gBACT,SAAS;oBAAE,KAAK;oBAAI,QAAQ;gBAAG;gBAC/B,qBAAqB;gBACrB,gBAAgB;gBAChB,iBAAiB;gBACjB,yBAAyB;oBAAE,SAAS;gBAAK;YAC3C;;;;;;;;;;;AAIR"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///home/bianca/Documents/compi/ProyectoCompi/frontend/components/memory-visualizer.tsx"],"sourcesContent":["\"use client\"\n\nimport { useEffect, useMemo, useState } from \"react\"\nimport { ImageIcon } from \"lucide-react\"\nimport type { StackFrame } from \"@/lib/compiler-service\"\n\ninterface MemoryVisualizerProps {\n  imageBase64?: string\n  stack?: StackFrame[]\n  output?: string\n  activeIndex: number\n  setActiveIndex: (idx: number) => void\n}\n\nexport function MemoryVisualizer({ imageBase64, stack, output, activeIndex, setActiveIndex }: MemoryVisualizerProps) {\n  const hasStack = useMemo(() => !!stack && stack.length > 0, [stack])\n  const snaps = stack ?? []\n\n  const diffForIndex = (idx: number) => {\n    const snap = snaps[idx]\n    const prevSnap = idx > 0 ? snaps[idx - 1] : undefined\n    if (!snap) return { added: [] as string[], updated: new Set<string>() }\n    const prevMap = prevSnap ? new Map(prevSnap.vars.map((v) => [v.name, v])) : new Map<string, typeof snap.vars[number]>()\n    const added: string[] = []\n    const updated = new Set<string>()\n    snap.vars.forEach((v) => {\n      const p = prevMap.get(v.name)\n      if (!p) {\n        added.push(v.name)\n      } else if (p.value !== v.value || p.offset !== v.offset) {\n        updated.add(v.name)\n      }\n    })\n    return { added, updated }\n  }\n\n  const current = snaps[activeIndex] ?? snaps[0]\n  const prev = activeIndex > 0 ? snaps[activeIndex - 1] : undefined\n\n  useEffect(() => {\n    if (activeIndex >= snaps.length) setActiveIndex(0)\n  }, [snaps.length, activeIndex, setActiveIndex])\n\n  const changes = useMemo(() => {\n    if (!current) return { added: [] as string[], updated: new Set<string>() }\n    const prevMap = prev ? new Map(prev.vars.map((v) => [v.name, v])) : new Map<string, typeof current.vars[number]>()\n    const added: string[] = []\n    const updated = new Set<string>()\n    current.vars.forEach((v) => {\n      const p = prevMap.get(v.name)\n      if (!p) {\n        added.push(v.name)\n      } else if (p.value !== v.value || p.offset !== v.offset) {\n        updated.add(v.name)\n      }\n    })\n    return { added, updated }\n  }, [current, prev])\n\n  if (!hasStack && !imageBase64) {\n    return (\n      <div className=\"h-full flex flex-col items-center justify-center gap-3 text-muted-foreground p-6 bg-gradient-to-b from-slate-950 via-slate-900 to-slate-950\">\n        <div className=\"w-12 h-12 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center\">\n          <ImageIcon className=\"opacity-70\" size={20} />\n        </div>\n        <p className=\"text-sm text-center\">La visualización de memoria aparecerá aquí...</p>\n      </div>\n    )\n  }\n\n  if (hasStack) {\n    return (\n      <div className=\"h-full w-full flex flex-col bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 border border-white/10\">\n        {/* Fila 1: Snapshots */}\n        <div className=\"border-b border-white/10 bg-white/5 px-3 py-2 space-y-2\">\n          <div className=\"flex items-center justify-between text-xs text-slate-300\">\n            <span className=\"uppercase tracking-[0.15em]\">Código / Snapshots</span>\n            <span>{snaps.length} paso(s)</span>\n          </div>\n          <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 max-h-40 overflow-auto scrollbar-transparent\">\n            {snaps.map((s, idx) => {\n              const diff = diffForIndex(idx)\n              return (\n                <button\n                  key={`${s.label}-${idx}`}\n                  onClick={() => setActiveIndex(idx)}\n                  className={`text-left rounded-xl border border-white/10 px-3 py-2 transition-colors ${\n                    activeIndex === idx\n                      ? \"bg-sky-500/80 text-slate-900 shadow-sm shadow-sky-500/40\"\n                      : \"bg-white/10 text-slate-100 hover:bg-white/20\"\n                  }`}\n                >\n                  <div className=\"flex items-center justify-between text-[11px] font-semibold font-mono uppercase tracking-wide\">\n                    <span>{s.label}</span>\n                    {s.line !== undefined && s.line > 0 && (\n                      <span className=\"text-[10px] text-slate-200 font-medium\">L{s.line}</span>\n                    )}\n                  </div>\n                  {(diff.added.length > 0 || diff.updated.size > 0) && (\n                    <div className=\"text-[10px] text-slate-200 mt-1 space-y-1\">\n                      {diff.added.length > 0 && (\n                        <div>\n                          <span className=\"text-emerald-300 font-semibold\">+ </span>\n                          {diff.added.join(\", \")}\n                        </div>\n                      )}\n                      {diff.updated.size > 0 && (\n                        <div>\n                          <span className=\"text-amber-300 font-semibold\">↻ </span>\n                          {Array.from(diff.updated).join(\", \")}\n                        </div>\n                      )}\n                    </div>\n                  )}\n                </button>\n              )\n            })}\n          </div>\n        </div>\n\n        {/* Fila 2: stack del snapshot activo */}\n        <div className=\"flex-1 overflow-auto p-4\">\n          {current ? (\n            <div className=\"rounded-2xl border border-white/10 bg-[#0d152a]/80 backdrop-blur-xl p-3 shadow-lg shadow-black/30 space-y-2\">\n              <div className=\"flex items-center justify-between text-xs text-slate-200 mb-1\">\n                <span className=\"font-semibold text-white uppercase tracking-wide text-[11px]\">\n                  {current.label}\n                </span>\n                {current.line !== undefined && current.line > 0 && (\n                  <span className=\"text-[10px] text-sky-200 font-mono\">Línea {current.line}</span>\n                )}\n              </div>\n              {(changes.added.length > 0 || changes.updated.size > 0) && (\n                <div className=\"text-[11px] text-slate-200\">\n                  {changes.added.length > 0 && (\n                    <div className=\"mb-1\">\n                      <span className=\"text-emerald-300 font-semibold\">Nuevas:</span>{\" \"}\n                      {changes.added.join(\", \")}\n                    </div>\n                  )}\n                  {changes.updated.size > 0 && (\n                    <div>\n                      <span className=\"text-amber-300 font-semibold\">Actualizadas:</span>{\" \"}\n                      {Array.from(changes.updated).join(\", \")}\n                    </div>\n                  )}\n                </div>\n              )}\n              <div className=\"w-full overflow-x-auto\">\n                <table className=\"min-w-full text-[11px] font-mono border border-white/10 rounded-xl overflow-hidden\">\n                  <thead className=\"bg-slate-800/70 text-slate-100 uppercase\">\n                    <tr>\n                      <th className=\"px-2 py-2 border-r border-white/10 text-left\">Var</th>\n                      <th className=\"px-2 py-2 border-r border-white/10 text-left\">Addr</th>\n                      <th className=\"px-2 py-2 text-left\">Val</th>\n                    </tr>\n                  </thead>\n                  <tbody>\n                    {current.vars.map((v, i) => (\n                      <tr\n                        key={`${v.name}-${i}`}\n                        className={`text-slate-100 ${\n                          changes.updated.has(v.name)\n                            ? \"bg-amber-500/30\"\n                            : \"odd:bg-white/5 even:bg-white/10\"\n                        }`}\n                      >\n                        <td className=\"px-2 py-2 border-r border-white/10\">\n                          <div className=\"font-semibold\">{v.name}</div>\n                          <div className=\"text-[10px] text-slate-400\">{v.type || \"\"}</div>\n                        </td>\n                        <td className=\"px-2 py-2 border-r border-white/10 text-sky-200\">\n                          {v.offset !== undefined ? `${v.offset}(%rbp)` : \"\"}\n                        </td>\n                        <td className=\"px-2 py-2 text-emerald-200\">{v.value || \"?\"}</td>\n                      </tr>\n                    ))}\n                    {current.vars.length === 0 && (\n                      <tr>\n                        <td colSpan={3} className=\"px-2 py-3 text-center text-slate-400\">\n                          Sin variables en este frame\n                        </td>\n                      </tr>\n                    )}\n                  </tbody>\n                </table>\n              </div>\n            </div>\n          ) : (\n            <div className=\"text-sm text-slate-400\">Sin snapshot seleccionado.</div>\n          )}\n        </div>\n      </div>\n    )\n  }\n\n  // Fallback: imagen base64 del backend\n  return (\n    <div className=\"h-full w-full flex flex-col bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 border border-white/10\">\n      <div className=\"flex items-center justify-between px-3 py-2 border-b border-white/10 bg-white/5 text-xs text-slate-200\">\n        <span className=\"uppercase tracking-[0.15em] text-slate-400\">Memoria / Stack (imagen)</span>\n      </div>\n\n      <div className=\"flex-1 overflow-auto p-4\">\n        <div className=\"relative w-full min-h-[300px] flex justify-center\">\n          <img\n            src={`data:image/png;base64,${imageBase64}`}\n            alt=\"Diagrama de Memoria\"\n            className=\"shadow-2xl shadow-black/40 border border-white/10 rounded-2xl max-w-full h-auto\"\n          />\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 588, "column": 0}, "map": {"version":3,"sources":["file:///home/bianca/Documents/compi/ProyectoCompi/frontend/lib/compiler-service.tsx"],"sourcesContent":["export interface CompilationResponse {\n  success: boolean\n  output: string\n  image_b64?: string\n  logs: string\n  stack?: StackFrame[]\n  asm?: string\n}\n\nexport type StackVar = {\n  name: string\n  value: string\n  offset?: number\n  type?: string\n}\n\nexport type StackFrame = {\n  label: string\n  vars: StackVar[]\n  sp?: number\n  line?: number\n}\n\nconst API_URL = process.env.NEXT_PUBLIC_COMPILER_API_URL || \"http://localhost:8000\"\n\nexport async function compileCode(code: string): Promise<CompilationResponse> {\n  try {\n    const response = await fetch(`${API_URL}/compile`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n      body: JSON.stringify({ code }),\n    })\n\n    if (!response.ok) {\n      throw new Error(\"Compilation failed\")\n    }\n\n    return response.json()\n  } catch (error) {\n    console.error(\"Error conectando con el compilador:\", error)\n    throw error\n  }\n}\n"],"names":[],"mappings":";;;;AAuBA,MAAM,UAAU,6DAA4C;AAErD,eAAe,YAAY,IAAY;IAC5C,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,GAAG,QAAQ,QAAQ,CAAC,EAAE;YACjD,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;gBAAE;YAAK;QAC9B;QAEA,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO,SAAS,IAAI;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uCAAuC;QACrD,MAAM;IACR;AACF"}},
    {"offset": {"line": 617, "column": 0}, "map": {"version":3,"sources":["file:///home/bianca/Documents/compi/ProyectoCompi/frontend/app/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState } from \"react\"\nimport { Play, Activity, AlertCircle, Code2, Zap, FileCode2 } from \"lucide-react\"\nimport { GrammarPanel } from \"@/components/grammar-panel\"\nimport { MemoryVisualizer } from \"@/components/memory-visualizer\"\nimport { compileCode, type StackFrame } from \"@/lib/compiler-service\"\n\nexport default function Home() {\n  const [code, setCode] = useState(\n    `#include <stdio.h>\n\nint main() {\n    int x;\n    int y;\n    long z;\n\n    x = 1;\n    y = 10;\n    z = 1000000;\n\n    x = 20;\n\n    printf(\" %d\\\\n\", x);\n    printf(\" %d\\\\n\", y);\n    printf(\" %ld\\\\n\", z);\n\n    return 0;\n}`,\n  )\n\n  const [output, setOutput] = useState(\"\")\n  const [logs, setLogs] = useState(\"\")\n  const [image, setImage] = useState(\"\")\n  const [stack, setStack] = useState<StackFrame[]>([])\n  const [asm, setAsm] = useState(\"\")\n  const [loading, setLoading] = useState(false)\n  const [activeTab, setActiveTab] = useState<\"memory\" | \"logs\">(\"memory\")\n  const [activeSnap, setActiveSnap] = useState(0)\n  const activeSnapshot = stack[activeSnap]\n  const totalSnapshots = stack.length\n\n  const goPrev = () => setActiveSnap((idx) => (idx > 0 ? idx - 1 : idx))\n  const goNext = () => setActiveSnap((idx) => (idx + 1 < totalSnapshots ? idx + 1 : idx))\n  const handleRun = async () => {\n    setLoading(true)\n    setOutput(\"\")\n    setLogs(\"\")\n    setImage(\"\")\n    setStack([])\n    setAsm(\"\")\n    setActiveSnap(0)\n\n    try {\n      const result = await compileCode(code)\n      setOutput(result.output)\n      setLogs(result.logs)\n      setImage(result.image_b64 || \"\")\n      setStack(result.stack || [])\n      setAsm(result.asm || \"\")\n      setActiveTab(result.stack && result.stack.length > 0 ? \"memory\" : \"logs\")\n    } catch (error) {\n      setOutput(\"Error de conexión con el servidor.\")\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground\">\n      {/* Header */}\n      <header className=\"border-b border-border bg-card/50 backdrop-blur-sm sticky top-0 z-50\">\n        <div className=\"max-w-[1600px] mx-auto px-6 h-14 flex items-center justify-between\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"flex items-center justify-center w-8 h-8 rounded-lg bg-accent/10 border border-accent/20\">\n              <Code2 size={16} className=\"text-accent\" />\n            </div>\n            <div className=\"flex items-center gap-2\">\n              <span className=\"font-semibold text-foreground\">Orbit</span>\n              <span className=\"text-muted-foreground text-sm hidden sm:inline\">/ Compiler</span>\n            </div>\n          </div>\n\n          <div className=\"flex items-center gap-4\">\n            <div className=\"hidden sm:flex items-center gap-2 px-3 py-1.5 rounded-full bg-muted border border-border text-xs\">\n              <span className={`w-1.5 h-1.5 rounded-full ${loading ? \"bg-warning animate-pulse\" : \"bg-success\"}`} />\n              <span className=\"text-muted-foreground\">{loading ? \"Compilando...\" : \"Listo\"}</span>\n            </div>\n\n            <button\n              onClick={handleRun}\n              disabled={loading}\n              className={`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200 ${\n                loading\n                  ? \"bg-muted text-muted-foreground cursor-wait\"\n                  : \"bg-accent hover:bg-accent/90 text-accent-foreground shadow-lg shadow-accent/20\"\n              }`}\n            >\n              {loading ? (\n                <>\n                  <div className=\"w-3.5 h-3.5 border-2 border-muted-foreground/30 border-t-muted-foreground rounded-full animate-spin\" />\n                  <span className=\"hidden sm:inline\">Compilando</span>\n                </>\n              ) : (\n                <>\n                  <Play size={14} fill=\"currentColor\" />\n                  <span>Ejecutar</span>\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n      </header>\n\n      {/* Main Content */}\n      <main className=\"max-w-[1600px] mx-auto p-4 md:p-6\">\n        {/* Controles de paso a paso */}\n        <div className=\"flex items-center justify-between mb-3 text-sm text-muted-foreground\">\n          <div className=\"flex items-center gap-3\">\n            <span className=\"font-medium text-foreground\">Modo línea por línea</span>\n            <span className=\"text-xs\">\n              {totalSnapshots > 0\n                ? `Paso ${activeSnap + 1} de ${totalSnapshots}`\n                : \"Sin pasos aún\"}\n            </span>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <button\n              onClick={goPrev}\n              disabled={activeSnap === 0 || totalSnapshots === 0}\n              className=\"px-3 py-1.5 rounded-md border border-border bg-muted/40 text-foreground text-xs disabled:opacity-50\"\n            >\n              ← Anterior\n            </button>\n            <button\n              onClick={goNext}\n              disabled={activeSnap + 1 >= totalSnapshots || totalSnapshots === 0}\n              className=\"px-3 py-1.5 rounded-md border border-border bg-muted/40 text-foreground text-xs disabled:opacity-50\"\n            >\n              Siguiente →\n            </button>\n          </div>\n        </div>\n\n        <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-4 h-[calc(100vh-7rem)]\">\n          {/* Code Editor Panel */}\n          <div className=\"lg:col-span-1 rounded-xl bg-card border border-border overflow-hidden flex flex-col\">\n            <div className=\"flex items-center justify-between px-4 h-11 border-b border-border bg-muted/30\">\n              <div className=\"flex items-center gap-3\">\n                <div className=\"flex items-center gap-1.5\">\n                  <span className=\"w-3 h-3 rounded-full bg-destructive/80\" />\n                  <span className=\"w-3 h-3 rounded-full bg-warning/80\" />\n                  <span className=\"w-3 h-3 rounded-full bg-success/80\" />\n                </div>\n                <div className=\"flex items-center gap-2 text-sm\">\n                  <span className=\"text-foreground font-medium\">main.c</span>\n                </div>\n              </div>\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <Zap size={12} />\n                <span>x86-64</span>\n              </div>\n            </div>\n            <div className=\"flex-1 min-h-0 flex flex-col\">\n              <div className=\"flex-1 min-h-0\">\n                <GrammarPanel code={code} setCode={setCode} />\n              </div>\n              <div className=\"border-t border-border bg-muted/20 h-32 px-3 py-2 overflow-auto scrollbar-transparent\">\n                <div className=\"text-xs uppercase tracking-[0.15em] text-muted-foreground mb-1\">Salida</div>\n                <pre className=\"text-xs font-mono text-foreground whitespace-pre-wrap\">\n                  {output || <span className=\"text-muted-foreground italic\">Sin salida.</span>}\n                </pre>\n              </div>\n            </div>\n          </div>\n\n          {/* Columna ASM */}\n          <div className=\"rounded-xl bg-card border border-border overflow-hidden flex flex-col\">\n            <div className=\"px-4 h-11 border-b border-border bg-muted/30 flex items-center justify-between\">\n              <div className=\"flex items-center gap-2 text-xs text-muted-foreground\">\n                <FileCode2 size={12} />\n                <span className=\"uppercase tracking-[0.15em]\">ASM</span>\n              </div>\n              {activeSnapshot?.line ? (\n                <div className=\"text-[11px] text-muted-foreground font-mono\">\n                  Línea {activeSnapshot.line}\n                </div>\n              ) : null}\n            </div>\n            <div className=\"flex-1 p-4 overflow-auto min-h-[480px] scrollbar-transparent\">\n              <pre className=\"font-mono text-xs text-accent-foreground whitespace-pre-wrap leading-relaxed bg-muted/20 rounded-md p-3 border border-border h-full\">\n                {(() => {\n                  const lines = (asm || \"\").split(\"\\n\")\n                  const label = activeSnapshot?.label || \"\"\n                  const markerBase = label ? `# SNAP ${label}` : \"\"\n                  const marker = activeSnapshot?.line ? `${markerBase} line ${activeSnapshot.line}` : markerBase\n                  let idx = marker ? lines.findIndex((l) => l.includes(marker)) : -1\n                  if (idx === -1 && markerBase) {\n                    idx = lines.findIndex((l) => l.includes(markerBase))\n                  }\n                  const previousMarker =\n                    activeSnap > 0 && stack[activeSnap - 1]\n                      ? (() => {\n                          const prev = stack[activeSnap - 1]\n                          const base = `# SNAP ${prev.label}`\n                          return prev.line ? `${base} line ${prev.line}` : base\n                        })()\n                      : \"\"\n                  let prevIdx = -1\n                  if (previousMarker) {\n                    prevIdx = lines.findIndex((l) => l.includes(previousMarker))\n                    if (prevIdx === -1 && previousMarker.startsWith(\"# SNAP\")) {\n                      const baseOnly = `# SNAP ${stack[activeSnap - 1]?.label || \"\"}`\n                      prevIdx = lines.findIndex((l) => l.includes(baseOnly))\n                    }\n                  }\n                  const start = prevIdx >= 0 ? prevIdx + 1 : 0\n                  const end = idx >= 0 ? idx + 1 : lines.length\n                  const view = lines.slice(start, end)\n                  return view.map((line, i) => {\n                    const highlight = marker && line.includes(marker)\n                    return (\n                      <div\n                        key={i}\n                        className={highlight ? \"bg-sky-500/20 px-1 rounded text-slate-900\" : undefined}\n                      >\n                        {line || \" \"}\n                      </div>\n                    )\n                  })\n                })()}\n              </pre>\n            </div>\n          </div>\n\n          {/* Columna Memoria / Logs */}\n          <div className=\"rounded-xl bg-card border border-border overflow-hidden flex flex-col\">\n            <div className=\"flex items-center gap-1 px-2 h-11 border-b border-border bg-muted/30\">\n              {([\"memory\", \"logs\"] as const).map((tab) => (\n                <button\n                  key={tab}\n                  onClick={() => setActiveTab(tab)}\n                  className={`flex items-center gap-2 px-3 py-1.5 rounded-md text-xs font-medium transition-all duration-200 ${\n                    activeTab === tab\n                      ? \"bg-accent text-accent-foreground shadow-sm\"\n                      : \"text-muted-foreground hover:text-foreground hover:bg-muted\"\n                  }`}\n                >\n                  {tab === \"memory\" && <Activity size={12} />}\n                  {tab === \"logs\" && <AlertCircle size={12} />}\n                  <span className=\"capitalize\">{tab === \"memory\" ? \"Memoria\" : \"Logs\"}</span>\n                </button>\n              ))}\n            </div>\n            <div className=\"flex-1 overflow-hidden\">\n              {activeTab === \"memory\" && (\n                <div className=\"h-full\">\n                  <MemoryVisualizer\n                    imageBase64={image}\n                    stack={stack}\n                    output={output}\n                    activeIndex={activeSnap}\n                    setActiveIndex={setActiveSnap}\n                  />\n                </div>\n              )}\n              {activeTab === \"logs\" && (\n                <div className=\"h-full p-4 overflow-auto\">\n                  <pre className=\"font-mono text-xs text-warning whitespace-pre-wrap leading-relaxed\">\n                    {logs || <span className=\"text-muted-foreground italic\">No hay logs disponibles.</span>}\n                  </pre>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </main>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}